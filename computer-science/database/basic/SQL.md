# SQL(Structured Query Language)
- 관계형 데이터베이스(RDB)를 지원하는 언어
- 질의어지만, 데이터 구조의 정의, 데이터 조작, 데이터 제어 기능을 모두 갖춤
- 관계 대수와 관계 해석을 기초로 한 고급 데이터 언어

<br>

# SQL 분류

참고: 질의어(Query)란 데이터베이스 파일과 범용 프로그래밍 언어를 정확히 알지 못하는 단말 사용자들이 단말기를 통해서 대화식으로 쉽게 DB를 이용할 수 있게 하는 **비절차적인** 언어

<br>

# DDL(Data Define Language, 데이터 정의어)
- DDL은 Schema, Domain, Table, View, Index를 정의, 변경 또는 삭제할 때 사용하는 언어
- **DB를 구축하거나 수정할 목적으로 사용하는 언어**
- 데이터베이스 관리자나 데이터베이스 설계자가 사용
- DDL의 명령어는 아래와 같다

| 명령어       |                기능                    |
| --------     | ----------------------------------    |
| CREATE       | 스키마, 도메인 등을 정의하는데 사용    |
| ALTER        | 테이블에 대한 정의를 변경하는 데 사용  |
| DROP         | 스키마, 도메인 등을 삭제하는데 사용    |

ALTER: ADD(새로운 속성을 추가할 때 사용), ALTER(속성 변경), DROP COLUMN(특정 속성을 삭제할 때 사용)


<br>

서브 명령어
- CONSTRAINT: 제약조건의 이름을 지정, 지정할 필요 없으면 생략하고 CHECK 명령어만 사용
- CHECK: 속성 값에 대한 제약 조건을 정의
- UNIQUE: 대체키로 사용할 속성 또는 속성의 집합을 지정
- FOREIGN KEY ~ REFERENCES ~: 다른 테이블을 참조할 때 사용할 외래키 속성을 지정, **참조 무결성의 CASCADE 법칙이** 적용!

<br>

### 무결성의 CASCADE 법칙
- 참조 무결성 제약이 설정된 기본 테이블의 어떤 데이터를 삭제할 경우, 그 데이터와 밀접하게 연관되어 있는 **다른 테이블의 데이터들도 도미노처럼 자동으로 삭제**(계단식, 연속성)

<br>

### CHAR vs VARCHAR
- CHAR은 항상 지정된 크기만큼 기억장소가 미리 확보됨
- VARCHRA은 기억 장소의 크기가 지정되어도, 필드에 저장된 크기 만큼 기억 장소가 확보

<br>

### Clustered index vs non-clusterd index
- 클러스터드 인덱스는 인덱스 순서에 따라 데이터가 실제 저장 장소에서도 정렬되어 저장되는 방식. 이러한 방식은 검색속도 빠름, 그러나 삽입,삭제가 일어날 때마다 정렬
- 넌클러스터드 인덱스는 인덱스의 키 값만 정렬되어 있고, 실제 저장 장소는 정렬되지 않는 방식, 검색속도는 클러스터드 인덱스보다 느림

<br><br>

## 용어 정리

### 스키마(schema)
- 데이터 베이스의 구조와 제약 조건에 관한 전반적인 명세를 기술한 것
- 데이터 개체(Entity), 속성(Attribute), 관계(Relationship) 및 데이터 조작 시 데이터 값들이 갖는 제약 조건 등에 전반적으로 정의

### 도메인(domain)
- 도메인이란 하나의 속성이 취할 수 있는 동일한 유형의 원자값들의 집합을 의미
- 쉽게 말하면, 특정 속성에서 사용할 데이터의 범위를 사용자가 정의하는 사용자 정의 데이터 타입

### 테이블(table)
- 데이터 베이스의 설계 단계에서 릴레이션(Relation)이 조작이나 검색시에는 테이블이라고 부름
- 본질적으로 똑같은 의미

### 뷰(view)
- 사용자에게 접근이 허용된 자료만을 제한적으로 보여주기 위해 하나 이상의 기본 테이블로부터 유도된, 이름을 가지는 가상 테이블
- 저장장치 내에 물리적으로 존재하지 않지만 사용자에게 있는 것처럼 간주
- 데이터 보정작업, 처리과정 시험 등 임시적인 작업을 위한 용도로 활용
- 데이터의 논리적 독립성을 제공할 수 있다
- 독립적인 인덱스를 가질 수 없다, ALTER VIEW문을 사용할 수없음 (뷰의 정의를 변경할 수 없다), 뷰로 구성된 내용에 대한 삽입, 삭제, 갱신, 연산에 제약

```
--문법--
CREATE VIEW 뷰이름[(속성이름[,속성이름])]AS SELECT문;

--고객 테이블에서 주소가 서울시인 고객들의 성명과 전화번호를 서울고객이라는 뷰로 만들어라--
CREATE VIEW 서울고객(성명, 전화번호)
AS SELECT 성명 전화번호
FROM 고객
WHERE 주소 = '서울시';

```

### 인덱스(index)
- 검색 시간을 단축시키기 위해 만든 보조적인 데이터 구조


# DCL(Data Control Language, 데이터 제어어)
- DCL은 데이터의 보안, 무결성, 회복, 병행 제어 등을 정의하는데 사용하는 언어
- 주로 데이터베이스 관리자가 데이터 관리를 목적으로 사용

| 명령어             |                기능                    |
| --------           | ----------------------------------    |
| GRANT/REVOKE       | 권한 부여 및 취소를 위한 명령어    |
| COMMIT              | 트랜잭션이 성공적으로 끝나면, 변경된 모든 내용을 DB에 반영하도록하는 명령어  |
| ROLLBACK               | 아직 커밋되지 않은 변경된 모든 내용들을 취소하고 데이터베이스를 이전 상태로 되돌리는 명령어    |
| SAVEPOINT | 트랜잭션 내에 롤백할 위치인 저장점을 지정하는 명령어 |

<br>

###  사용자 등급
- DBA: 데이터베이스 관리자
- RESOURCE: 데이터 베이스 및 테이블 생성 가능자
- CONNECT: 단순 사용자



```
GRANT RESOURCE TO MINHO;
```

GRANT 명령어 연습
```
// 권민호에게 <학생> 테이블에 대한 접근 및 조작에 관한 모든 권하을 부여하는 SQL 문을 작성
=> grant all on 학생 to 권민호;

// 권민호에게 <강좌> 테이블에 대해 삭제하는 권한을 부여하고, <강좌> 테이블에 대해 삭제하는 권한을 다른 사람에게 부여할 수 있는 권한을 부여하는 SQL 문
=> grant delete on 강좌 to 권민호 with grant option
```


# DML(Data Manipulation Language, 데이터 조작어)
- 데이터 베이스 사용자가 응용 프로그램이나 질의어를 통해 저장된 데이터를 실질적으로 관리하는데 사용되는 언어
- 데이터 베이스 사용자와 데이터베이스 관리 시스템 간의 인터페이스를 제공

| 명령어     |                기능                    |
| --------   | ----------------------------------    |
| SELECT     | 테이블에서 튜플 검색    |
| INSERT     | 테이블에서 새로운 튜플 삽입  |
| DELETE     | 테이블에서 튜플을 삭제    |
| UPDATE     | 테이블에서 튜플의 내용을 갱신 |


## INSERT INTO ~

```
INSERT INTO 테이블명([속성명1, 속성명2]) VALUES (데이터1, 데이터2);
```

- 대응하는 속성과 데이터는 개수와 데이터 유형이 일치해야한다.
- 기본 테이블의 모든 속성을 사용할 때는 속성명을 생략할 수 있다

연습
```
// 사원 테이블에 (이름-권민호, 부서-인터넷)을 삽입
=> insert into 사원(이름,부서) values("권민호","인터넷");

// 사원 테이블에 (장보고, 기획, 05/13/73, 홍제동, 90)을 삽입
=> insert into 사원 values("장보고","기획","#05/13/73#", "홍제동", 90);

// 사원 테이블에 있는 편집부의 모든 튜블을 편집부원(이름,생일,주소, 기본급) 테이블에 삽입
=> insert into 편집부원(이름,생일,주소, 기본급) select (이름,생일,주소,기본급) from 사원 where 부서='편집';

```

## DELETE FROM ~
삭제문은 기본 테이블에 있는 튜플들 중에서 특정 튜플(행)을 삭제할 때 사용
```
DELETE FROM 테이블명 WHERE 조건;
```

## UPDATE~ SET~
갱신문은 기본 테이블에 있는 튜플들 중에서 특정 튜플의 내용을 변경할 때 사용
```
UPDATE 테이블 명 SET 속성명 = 데이터 WHERE 조건
```


## SELECT~ FROM~
해당 문은 테이블을 구성하는 튜플들 중에서 전체 또는 조건을 만족하는 튜플을 검색하여 주기억장치 상에 임시 테이블로 구성하는 명령어


### SELECT 절
- GROUP BY 절: 특정 속성을 기준으로 그룹화하여 검색할 때 그룹화할 속성을 지정, 그룹함수와 함께 사용된다. 그룹함수는 COUNT, MAX, MIN, SUM, AVG 등이 존재
- HAVING 절: GROUP BY와 함께 사용되며, 그룹에 대한 조건을 지정
- ORDER BY 절: 특정 속성을 기준으로 정렬하여 검색할 때 사용